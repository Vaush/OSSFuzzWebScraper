Detailed report:

https://oss-fuzz.com/testcase?key=6497479275053056

Project: tpm2

Fuzzer: libFuzzer_tpm2_execute_command_fuzzer

Fuzz target binary: tpm2_execute_command_fuzzer

Job Type: libfuzzer_ubsan_tpm2

Platform Id: linux

Crash Type: Undefined-shift

Crash Address:

Crash State:

TPMI_DH_CONTEXT_Unmarshal

TPMS_CONTEXT_Unmarshal

ContextLoad_In_Unmarshal

Sanitizer: undefined (UBSAN)

Regressed:

https://oss-fuzz.com/revisions?job=libfuzzer_ubsan_tpm2&range=201702171125:201702172210

Reproducer Testcase:

https://oss-fuzz.com/download/AMIfv97YGvgdj4_3-Bu5NuKAxXy9XLdZGyz8L6GcDa3ZqZymeoB5K-PZFRY5lIRt8yjNtCLSKD7c3kSVDRFDer3yvxp_3MTNyw8z3xy68I-1fLAvBOJ2MGrIMzcKlcUvTwwgxgvnDLb7mHWJ5qIm1dEM57eP8RqgGr7nguzjsicLspdEfb99piT0vWvqnmPWg2RwTk70FpznWhtAT5tAi32OMEDEAAjjqltiE8g0B-KudFxgyVcjhhVlc0u2FSJoIGLFfCj4T-WIdPtav1QyxOkQxS0_ukYQcACW6T1g-qKofcoTUkVQzXgv26TaA9PcKXbwraaihJRf7yEgIgRUtWECAvoNhdK0igiqzPo8QZtXL_7aI2xevbZOut5oDlBMO_svEqOv3PmYCbfx9lcDjz7TOyyDdYVfFHImkqsbyErf2xE0B2buIKE?testcase_id=6497479275053056

Issue filed automatically.

See

https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md

for more information.

This bug is subject to a 90 day disclosure deadline. If 90 days elapse

without an upstream patch, then the bug report will automatically

become visible to the public.

